group_by(restaurant) %>%
summarise(Overall=as.numeric(format(round(mean(stars),2), nsmall = 2)))
df4
df5 = merge(x = df4, y = df3, by = "restaurant", all = TRUE)
df5 = df5[order(-df5$Overall),]
names = c("Restaurant", "Overall", "Sex</br> Female", "Male")
df5
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(Overall = s.numeric(format(round(mean(stars),2), nsmall = 2)), rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = data %>%
group_by(restaurant, sex) %>%
summarise_at(Overall = s.numeric(format(round(mean(stars),2), nsmall = 2)), rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = data %>%
group_by(restaurant, sex) %>%
summarise_at(c("Overall", "rating"), s.numeric(format(round(mean(stars),2), nsmall = 2)), as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = data %>%
group_by(restaurant, sex) %>%
summarise_at(c("Overall", "rating"), s.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = data %>%
group_by(restaurant, sex) %>%
summarise_at(c("Overall", "rating"), as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2))) %>%
summarise(Overall=as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2))) %>%
summarise(Overall=as.numeric(format(round(mean(stars),2), nsmall = 2)))
#df3 = pivot_wider(df3, names_from = sex, values_from = rating)
df3
#df4 = data %>%
#  group_by(restaurant) %>%
#df4
#df5 = merge(x = df4, y = df3, by = "restaurant", all = TRUE)
#df5 = df5[order(-df5$Overall),]
#names = c("Restaurant", "Overall", "Sex</br> Female", "Male")
#df5
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)),
summarise(Overall=as.numeric(format(round(mean(stars),2), nsmall = 2))))
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(across(everything(), list(as.numeric(format(round(mean(stars),2), nsmall = 2)))))
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(across(everything(), list(as.numeric(format(round(mean(stars),2), nsmall = 2)))))
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(across(everything(), list(mean(stars))))
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
df3
df4 = data %>%
group_by(restaurant) %>%
summarise(Overall=as.numeric(format(round(mean(stars),2), nsmall = 2)))
df4
df5 = cbind(df4, df3)
df5
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = data %>%
group_by(restaurant) %>%
summarise(Overall=as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df4
df5 = cbind(df4, df3)
df5
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = data %>%
group_by(restaurant) %>%
summarise(Overall=as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df4
df4 = cbind(df5, df4)
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = data %>%
group_by(restaurant) %>%
summarise(Overall=as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df4
df4 = cbind(df5, df4)
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = as.numeric(format(round(mean(data$stars),2), nsmall = 2))
df4
# df4 = cbind(df5, df4)
df = data.frame(table(data$restaurant))
df = df[order(-df$Freq),]
df2 = as.numeric(format(round((df$Freq*100/nrow(data)),2), nsmall = 2))
df2
df2 = cbind(df, df2)
#df2
df2 = rename(df2, c("Restaurant"="Var1", "Count"="Freq", "Percentage"="df2"))
knitr::kable(df2, row.names = FALSE, caption = "Restaurant customers")
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = as.numeric(format(round(mean(df3$stars),2), nsmall = 2))
df4
# df4 = cbind(df5, df4)
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
df3
# df4 = as.numeric(format(round(mean(df3$stars),2), nsmall = 2))
# df4
# df4 = cbind(df5, df4)
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df3 = pivot_wider(df3, names_from = sex, values_from = rating)
df3
# df4 = as.numeric(format(round(mean(df3$stars),2), nsmall = 2))
# df4
# df4 = cbind(df5, df4)
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
df3
df4 = as.numeric(format(round(mean(df3$stars),2), nsmall = 2))
df4
# df4 = cbind(df5, df4)
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
df3
df4 = as.numeric(format(round(mean(df3$stars),2), nsmall = 2))
df4
df5 =
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
df3
df4 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df4
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
df3
df4 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df4
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df4
df5 = merge.data.frame(df4, df3, by = restaurant)
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df4
df5 = merge.data.frame(df4, df3, by = df4$restaurant)
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df4 = df4[order(-df4$rating),]
df4
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df4 = df4[order(-df4$rating),]
df4
df5 = merge(df4, df3, by = restaurant)
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
df3
df4 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df4 = df4[order(-df4$rating),]
# df4
df5 = merge(df4, df3, by = restaurant)
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
df3
df4 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df4 = df4[order(-df4$rating),]
# df4
df5 = merge(df4, df3, by = restaurant, all.x = T)
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
df3
df4 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df4 = df4[order(-df4$rating),]
# df4
df5 = merge(df4, df3, by = "restaurant", all.x = T)
df5
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df4
df5 = merge(df4, df3, by = "restaurant", all.x = T)
df5 = df5[order(-df5$rating),]
df5
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df4
df5 = merge(df4, df3, by = "restaurant", all.x = T)
df5 = df5[order(-df5$rating),]
row.names(df5) = NULL
df5
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df4
df5 = merge(df4, df3, by = "restaurant", all.x = T)
df5 = df5[order(-df5$rating),]
row.names(df5) = NULL
# df5
kbl(df5) %>%
add_header_above(c("Sex"=3))
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df4
df5 = merge(df4, df3, by = "restaurant", all.x = T)
df5 = df5[order(-df5$rating),]
row.names(df5) = NULL
# df5
kbl(df5) %>%
add_header_above(c(" "=1," "=2,"Sex"=3))
View(df5)
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df4
df5 = merge(df4, df3, by = "restaurant", all.x = T)
df5 = df5[order(-df5$rating),]
row.names(df5) = NULL
df5
kbl(df5) %>%
add_header_above(c(" "=1," "=2,"Sex"=3,"Sex"=4))
df3 = data %>%
group_by(restaurant, sex) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df3 = pivot_wider(df3, names_from = sex, values_from = rating)
# df3
df4 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df4
df5 = merge(df4, df3, by = "restaurant", all.x = T)
df5 = df5[order(-df5$rating),]
row.names(df5) = NULL
df5
kbl(df5) %>%
add_header_above(c(" "=2,"Sex"=2))
data <- read.csv('data.csv', header = T, sep = ",", row.names = NULL)
library(knitr)
library(plyr)
library(dplyr)
library(tidyr)
library(magrittr)
library(kableExtra)
df = data.frame(table(data$restaurant))
df = df[order(-df$Freq),]
df2 = as.numeric(format(round((df$Freq*100/nrow(data)),2), nsmall = 2))
df2 = cbind(df, df2)
#df2
df2 = rename(df2, c("Restaurant"="Var1", "Count"="Freq", "Percentage"="df2"))
knitr::kable(df2, row.names = FALSE, caption = "Restaurant customers")
df = data.frame(table(data$restaurant))
df = df[order(-df$Freq),]
df2 = as.numeric(format(round((df$Freq*100/nrow(data)),2), nsmall = 2))
df2 = cbind(df, df2)
#df2
df2 = rename(df2, c("Restaurant"="Var1", "Count"="Freq", "Percentage"="df2"))
kbl(df2) %>%
kable_styling(caption = "Restaurant customers") %>%
# knitr::kable(df2, row.names = FALSE, caption = "Restaurant customers")
df = data.frame(table(data$restaurant))
df = df[order(-df$Freq),]
df2 = as.numeric(format(round((df$Freq*100/nrow(data)),2), nsmall = 2))
df2 = cbind(df, df2)
#df2
df2 = rename(df2, c("Restaurant"="Var1", "Count"="Freq", "Percentage"="df2"))
row.names(df2) = NULL
kbl(df2) %>%
kable_styling(caption = "Restaurant customers") %>%
# knitr::kable(df2, row.names = FALSE, caption = "Restaurant customers")
df = data.frame(table(data$restaurant))
df = df[order(-df$Freq),]
df2 = as.numeric(format(round((df$Freq*100/nrow(data)),2), nsmall = 2))
df2 = cbind(df, df2)
#df2
df2 = rename(df2, c("Restaurant"="Var1", "Count"="Freq", "Percentage"="df2"))
row.names(df2) = NULL
kbl(df2) %>%
kable_styling(caption = "Restaurant customers")
kbl(df2, caption = "Restaurant customers") %>%
kable_styling()
df6 = data %>%
group_by(restaurant, race) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df6 = pivot_wider(df3, names_from = race, values_from = rating)
df6 = data %>%
group_by(restaurant, race) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df6 = pivot_wider(df6, names_from = race, values_from = rating)
# df3
df7 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df4
df8 = merge(df7, df6, by = "restaurant", all.x = T)
df8 = df5[order(-df5$rating),]
row.names(df8) = NULL
# df5
kbl(df8, caption = "Average Customer Rating by **Race**") %>%
kable_styling() %>%
add_header_above(c(" "=2,"Race"=4))
df6 = data %>%
group_by(restaurant, race) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df6 = pivot_wider(df6, names_from = race, values_from = rating)
# df3
df7 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df4
df8 = merge(df7, df6, by = "restaurant", all.x = T)
df8 = df5[order(-df8$rating),]
row.names(df8) = NULL
# df5
kbl(df8, caption = "Average Customer Rating by **Race**") %>%
kable_styling() %>%
add_header_above(c(" "=2,"Race"=4))
df6 = data %>%
group_by(restaurant, race) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df6 = pivot_wider(df6, names_from = race, values_from = rating)
df3
df7 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df4
df8 = merge(df7, df6, by = "restaurant", all.x = T)
df8 = df5[order(-df8$rating),]
row.names(df8) = NULL
# df5
kbl(df8, caption = "Average Customer Rating by **Race**") %>%
kable_styling() %>%
add_header_above(c(" "=2,"Race"=4))
df6 = data %>%
group_by(restaurant, race) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df6 = pivot_wider(df6, names_from = race, values_from = rating)
df6
df7 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df4
df8 = merge(df7, df6, by = "restaurant", all.x = T)
df8 = df5[order(-df8$rating),]
row.names(df8) = NULL
# df5
kbl(df8, caption = "Average Customer Rating by **Race**") %>%
kable_styling() %>%
add_header_above(c(" "=2,"Race"=4))
df6 = data %>%
group_by(restaurant, race) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df6 = pivot_wider(df6, names_from = race, values_from = rating)
df6
df7 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df7
df8 = merge(df7, df6, by = "restaurant", all.x = T)
df8 = df5[order(-df8$rating),]
row.names(df8) = NULL
# df5
kbl(df8, caption = "Average Customer Rating by **Race**") %>%
kable_styling() %>%
add_header_above(c(" "=2,"Race"=4))
df6 = data %>%
group_by(restaurant, race) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df6 = pivot_wider(df6, names_from = race, values_from = rating)
# df6
df7 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df7
df8 = merge(df7, df6, by = "restaurant", all.x = T)
df8 = df5[order(-df8$rating),]
row.names(df8) = NULL
df8
# kbl(df8, caption = "Average Customer Rating by **Race**") %>%
#   kable_styling() %>%
#   add_header_above(c(" "=2,"Race"=4))
df6 = data %>%
group_by(restaurant, race) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df6 = pivot_wider(df6, names_from = race, values_from = rating)
# df6
df7 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df7
df8 = merge(df7, df6, by = "restaurant", all.x = T)
df8 = df8[order(-df8$rating),]
row.names(df8) = NULL
df8
# kbl(df8, caption = "Average Customer Rating by **Race**") %>%
#   kable_styling() %>%
#   add_header_above(c(" "=2,"Race"=4))
df6 = data %>%
group_by(restaurant, race) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
df6 = pivot_wider(df6, names_from = race, values_from = rating)
# df6
df7 = data %>%
group_by(restaurant) %>%
summarise(rating = as.numeric(format(round(mean(stars),2), nsmall = 2)))
# df7
df8 = merge(df7, df6, by = "restaurant", all.x = T)
df8 = df8[order(-df8$rating),]
row.names(df8) = NULL
# df8
kbl(df8, caption = "Average Customer Rating by **Race**") %>%
kable_styling() %>%
add_header_above(c(" "=2,"Race"=4))
